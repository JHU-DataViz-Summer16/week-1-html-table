<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Week 3: D3 DOM Tables</title><!-- Latest compiled and minified CSS -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
  <link type="text/css" rel="stylesheet" href="stylesheet.css"/>

</head>

<body>
<div class="header section">
  <div class="container">
    <h1>Week 3: D3 and the DOM</h1>
    <p>This table shows the total number of employees on nonfarm payrolls by state, in thousands, for March 2016.</p>
  </div>
</div>
<div class="controls section">
  <div class="container">
    <div class="btn-toolbar">
      <div class="btn-group">
        <button type="button" class="btn btn-default" id="sort-asc">Ascending</button>
        <button type="button" class="btn btn-default" id="sort-desc">Descending</button>
      </div>
      <div class="btn-group">
        <button type="button" class="btn btn-default" id="filter-ne">Northeast</button>
        <button type="button" class="btn btn-default" id="filter-so">South</button>
        <button type="button" class="btn btn-default" id="filter-mw">Midwest</button>
        <button type="button" class="btn btn-default" id="filter-we">West</button>
      </div>
    </div>
  </div>
</div>
<div class="main section">
  <div class="container">
    <table class="table" id="data-table">
      <thead>
        <tr>
          <th>State</th>
          <th>Employees (thousands)</th>
          <th>Region</th>
          <th>Chart</th>
        </tr>
      </thead>
      <tbody>
      </tbody>
    </table>
    <nav>
      <ul class="pager">
        <li class="previous"><a href="#" id="page-prev">Previous</a></li>
        <li class="next"><a href="#" id="page-next">Next</a></li>
      </ul>
    </nav>
  </div>
</div>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.17/d3.min.js"></script>
<script>
  var states = [
	{"state":"Alabama","employment":1959.0,"region":"South"},
	{"state":"Alaska","employment":338.4,"region":"West"},
	{"state":"Arizona","employment":2691.9,"region":"West"},
	{"state":"Arkansas","employment":1224.4,"region":"South"},
	{"state":"California","employment":16321.9,"region":"West"},
	{"state":"Colorado","employment":2595.8,"region":"West"},
	{"state":"Connecticut","employment":1686.3,"region":"Northeast"},
	{"state":"Delaware","employment":458.6,"region":"South"},
	{"state":"District of Columbia","employment":773.8,"region":"South"},
	{"state":"Florida","employment":8252.8,"region":"South"},
	{"state":"Georgia","employment":4360.7,"region":"South"},
	{"state":"Hawaii","employment":651.4,"region":"West"},
	{"state":"Idaho","employment":691.7,"region":"West"},
	{"state":"Illinois","employment":6006.7,"region":"Midwest"},
	{"state":"Indiana","employment":3062.1,"region":"Midwest"},
	{"state":"Iowa","employment":1576.5,"region":"Midwest"},
	{"state":"Kansas","employment":1399.2,"region":"Midwest"},
	{"state":"Kentucky","employment":1908.9,"region":"South"},
	{"state":"Louisiana","employment":1977.1,"region":"South"},
	{"state":"Maine","employment":614.6,"region":"Northeast"},
	{"state":"Maryland","employment":2704.6,"region":"South"},
	{"state":"Massachusetts","employment":3537.1,"region":"Northeast"},
	{"state":"Michigan","employment":4324.9,"region":"Midwest"},
	{"state":"Minnesota","employment":2876.2,"region":"Midwest"},
	{"state":"Mississippi","employment":1147.1,"region":"South"},
	{"state":"Missouri","employment":2801.2,"region":"Midwest"},
	{"state":"Montana","employment":464.6,"region":"West"},
	{"state":"Nebraska","employment":1017.3,"region":"Midwest"},
	{"state":"Nevada","employment":1282.7,"region":"West"},
	{"state":"New Hampshire","employment":664.9,"region":"Northeast"},
	{"state":"New Jersey","employment":4073.9,"region":"Northeast"},
	{"state":"New Mexico","employment":827.6,"region":"West"},
	{"state":"New York","employment":9332.9,"region":"Northeast"},
	{"state":"North Carolina","employment":4310.5,"region":"South"},
	{"state":"North Dakota","employment":440.0,"region":"Midwest"},
	{"state":"Ohio","employment":5491.4,"region":"Midwest"},
	{"state":"Oklahoma","employment":1666.0,"region":"South"},
	{"state":"Oregon","employment":1823.2,"region":"West"},
	{"state":"Pennsylvania","employment":5894.6,"region":"Northeast"},
	{"state":"Rhode Island","employment":490.6,"region":"Northeast"},
	{"state":"South Carolina","employment":2039.6,"region":"South"},
	{"state":"South Dakota","employment":432.3,"region":"Midwest"},
	{"state":"Tennessee","employment":2951.7,"region":"South"},
	{"state":"Texas","employment":11961.6,"region":"South"},
	{"state":"Utah","employment":1411.7,"region":"West"},
	{"state":"Vermont","employment":316.5,"region":"Northeast"},
	{"state":"Virginia","employment":3919.1,"region":"South"},
	{"state":"Washington","employment":3230.5,"region":"West"},
	{"state":"West Virginia","employment":761.8,"region":"South"},
	{"state":"Wisconsin","employment":2936.2,"region":"Midwest"},
	{"state":"Wyoming","employment":284.4,"region":"West"}
  ];

  var MAX_EMPLOYMENT = 16322;

  var options = {
    sorted: false,
    filtered: false,
    page: 0
  };
    
    
    var tbody = d3.select("tbody");


  function updateTable(){
      
    // Erase any existing html code within tbody by replacing it with a blank string "".
    tbody.html("");

    // Binding data - this will be a very common task in our use of D3. Start by making a selectAll of <tr> elements that do not yet exist (they will soon!).
    // Then we bind our data (schools) with .data and .enter()
    // Lastly, we append the <tr> elements, which are become our current selection because of the prior selectAll("tr")
    var rows = tbody.selectAll("tr")
      .data(states)
      .enter()
      .append("tr");

    // If you run, console.log(rows), you should now see an array of <tr> elements printed out to the console, each of which should contain a __data__ property containing one object from our JSON array.
    console.log(rows);

    // Take the rows variable and append a <td> elements containing d.name - the name of each schools for each bound data element.
    rows.append("td")
      .html(function(d) { return d.state });
      
//    console.log(rows.append("td").html());

    rows.append("td")
        .html(function(d) { return d.employment });

    rows.append("td")
      .html(function(d) { return d.region });

    // Same as above, calculating a percent of the space allowed that the div should fill:
    rows.append("td")
      .append("div")
      .classed("bar", true)
      .style("width", function(d) { return ((d.employment / MAX_EMPLOYMENT) * 100) + '%' })

  };   
    
    


  updateTable();
    


//        d3.select("#sort-asc")
//    .on("click", function(){
//
//    console.log("msg asc");
//    options.sorted = 'asc';
    d3.select("#sort-asc").on("click", function(k) {
        d3.select('#sort-desc').classed('active', false);
        d3.select('#sort-asc').classed('active', true);    
    d3.selectAll("tbody tr").sort(function(a, b) { return d3.ascending(a.employment, b.employment); });    
    });

    d3.select("#desc-asc").on("click", function(k) {
    d3.selectAll("tbody tr").sort(function(a, b) { return d3.descending(a.employment, b.employment); });    
    });
    




</script>

  <p>Source: <a href="http://www.bls.gov/home.htm">Bureau of Labor Statistics</a></p>
</body>
</html>
